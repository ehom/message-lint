#!/usr/bin/env python3

import os
import sys
from pprint import PrettyPrinter

# print("os.pardir:", os.pardir)
fpath = os.path.join(os.path.dirname(__file__), '..')
sys.path.append(fpath)

from utils import FileProcessor
from utils import FileWriter

custom_printer = PrettyPrinter(
    indent=4,
    width=100,
    compact=True
)


def process(filename):
    processor = FileProcessor.get(filename)
    bins = processor.process()
    writer = FileWriter.get(filename)

    for binName, contents in bins.items():
        print("Printing contents of bin...")
        custom_printer.pprint(contents)

        print("binName:", binName)
        writer.write(binName, contents)

    if len(bins):
        print("bins:", bins.keys())


def main():
    arg_count = len(sys.argv)

    for i in range(1, arg_count):
        process(sys.argv[i])


if __name__ == "__main__":
    main()
